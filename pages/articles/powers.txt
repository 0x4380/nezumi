====== советы по доработке дешевых блоков питания ======
<sub>{{PowerS.odt|Original file}}</sub>

крис касперски ака мыщъх, no-email

**качественные блоки питания — не то, чтобы редкость, но явление отнюдь не повсеместное. китайские мастера ухитряются собирать блоки питания, выкинув из них максимум деталей, совершенно не заботясь о последствиях. ну какое им дело до сбоев сервера или полного выгорания всех ****его компонентов****? вот и приходится брать паяльник в ****лапы и доводить китайское чудо до технологического совершенства**

{{INLINETOC}}
===== введение =====

Существует мнение, что в блок питания лучше вообще не лазить, а сразу покупать хороший и надежный, в котором все, что нужно уже сделано. Увы! Таких блоков питания по-видимому просто не существует. Конкурентная борьба диктует свои схематические решения и если качество фильтрации напряжения производители еще хоть как-то принимают во внимание (в противном случае тестовые лаборатории тут же забанят такой блок питания на хрен), то защита компьютера от перенапряжения практически никак и некем не реализована, что открывает огромный творческий простор для кустарной доработки, идущей блоку питания только на пользу.

Бытует мнение, что хороший блок питания отличить от плохо можно по… весу! Действительно, легкий блок питания с надписью 450 Ватт идет в баню вместе с китайскими колонками с заявленной мощностью в 1000 Ватт, но… сам по себе вес ничего не значит! Корпус из толстого металла, массивные радиаторы, добротные дроссели и трансформаторы — все это, безусловно, очень хорошо, но схемотехнические решения многих тяжелых блоков питания просто ужасны. И даже высокая цена отнюдь не показатель качества. До тех пор, пока мы не заберемся внутрь и не пощупаем все узлы своими руками, ничего конкретного сказать вообще нельзя. Кстати говоря, практически все блоки питания построены по одному и тому же принципу и потому их принципиальные схемы довольно похожи. В качестве наглядного примера одна из таких схем приведена ниже (см. рис. 2).

Естественно, прежде срывать гарантийную пломбу, необходимо научиться правильно паять и насобачиться с ремонтом более простых приборов (успешный ремонт электрического чайника — не в счет). Все эксперименты с блоком питания следует проводить _только_ в "автономном" режиме (то есть, без компьютера), используя в качестве нагрузки резисторы или лампы накаливания соответствующей мощности, контролируя напряжение вольтметром (см. рис. 1). Без нагрузки блок питания включать недопустимо, даже если он не выйдет из строя, то не "заведется", а если и "заведется", то значения выходных напряжений окажутся весьма далекими от реальной действительности.

{{powers_Image_0.png}}

**Рисунок 1 номиналы резисторов для создания испытательной нагрузки**

Главным образом мы будем говорить о "бюджетных" блоках питания, установленных в домашних серверах или серверах небольших организаций. Работать им приходится в суровых условиях круглосуточного режима, зачастую при повышенных температурах, (ведь подобные "серверные" в отличии от кабинетов не имеют не только кондиционера, но даже и дешевого вентилятора), причем все это — безо всякого присмотра! Неудивительно, что блоки питания, едва отработав гарантийный срок, заканчивают жизнь самоубийством, от которого их может спасти только доработка.

{{powers_Image_1.png}}

**Рисунок 2 принципиальная схема типичного блока питания**

===== вентиляторы =====

Остановка (или замедление вращения) вентилятора не приводит к немедленному отказу блока питания, однако, вызывает перегрев его элементов, ведущий к необратимой деградации кристаллов и ускоренному высыханию электролитов (//**примечание**////: на танталовые конденсаторы это не распространяется, да только в дешевых моделях их не встретишь//). Электронные ключи уходят в утечку, еще больше усиливающую разогрев электролитов, в точке соединения обкладок которых с выводами протекают деструктивные химические процессы, способствующие росту эквивалентного последовательного сопротивления (ESR), а сопротивление – это прежде всего тепло, рассеиваемое конденсатором, и приводящее к его "вспучиванию" с отказом выполнять свои прямые функциональные обязанности. Хорошо, если дело кончится срабатыванием защиты и "самоизоляцией" блока питания. Хуже, если в нем что-то пробьет и вспыхнет локальный пожар, последствия которого довольно предсказуемы. Но не будем о грустном.

Берем любой (подходящий по габаритам) вентилятор с датчиком вращения и выводим его на материнскую плату, что позволяет вести постоянный мониторинг оборотов как штатными средствами (с помощью BIOS), так и различными утилитами. Не так уж сложно написать программу, отправляющую SMS на телефон администратора, если обороты упадут ниже допустимого уровня.

Еще лучше — закрепить на передней стенке блока питания (та, что ближе к приводу CD/DVD-ROM) второй вентилятор, дующий в том же направлении что и первый (как правило, выдувающий воздух из корпуса наружу). Этот второй вентилятор настоятельно рекомендуется "накрыть" радиатором от процессора, чтобы его ребра (гнутые, конечно) превратились в своеобразную "ловушку" для пыли, оседающую на радиаторе-сетке (который ничего не охлаждает), а не на радиаторах внутри блока питания, теплоотдача которых от этого значительно уменьшается, а устраивать плановую продувку один или два раза в год администраторы, естественно, забывают.

===== устранение перекоса напряжения =====

Практически все "бюджетные" блоки питания имеют крайне примитивную цепь обратной связи, приводящую к перекосу напряжений по линиям +5 и +12 Вольт. Стабилизатор, собранный на ШИМ-микросхеме (что расшифровывается как "широтно-импульсный модулятор"), в _очень_ грубом приближении можно уподобить операционному усилителю, охваченному отрицательной обратной связью, соединяющей вход в выходом. При увеличении напряжения на выходе, сигнал на входе уменьшается в результате чего выходной сигнал падает. И, соответственно, наоборот, за счет чего и обеспечивается стабилизация.

Если бы блок питания выдавал только одно напряжение (или в нем стояло бы две ШИМ-микросхемы), никаких проблем не было бы. Но у нас есть всего _одна_ ШИМ-микросхема и _два_ выходных напряжения +5+ 12 Вольт (линию 3.3 Вольта мы не берем в расчет, т. к. она обычно запитывается от отдельного стабилизатора, а линии -5 и -12 Вольт чаще всего вообще не стабилизированы, впрочем, от китайцев можно ожидать всего чего угодно и, в том числе нестабилизированных 3.3 Вольт).

Что мы имеем? Чтобы хоть как-то заставить стабилизатор функционировать, по обратной связи на ШИМ-микросхему подается _усредненное_ напряжение, снимаемое делителем с линий +5 и +12 Вольт. При равномерном распределении нагрузки между обоими линиями блок питания работает нормально, но… в том-то и дело, что нагрузка редко бывает равномерной и потому блоки питания искусственно затачиваются производителем под типичную конфигурацию рабочей станции, которая существенно отличается от конфигурации сервера, доверху забитого жесткими дисками, запитанных от линии +12 Вольт.

Как следствие — в линии +12 Вольт возникает "провал" и среднее напряжение падает. Стабилизатор реагирует на это повышением напряжения на линии +12 Вольт, но… вместе с ней поднимается и +5 Вольт, причем, значительно сильнее! С другой стороны, если линия +5 Вольт недогружена, на ней образуется "избыток" напряжения, а на +12 Вольт возникает "провал" приводящий к нестабильной работе жестких дисков и зачастую — к потере данных.

В серверных блоках питания эта проблема решается введением второго трансформатора и второй микросхемы ШИМ, которые, между прочим, денег стоят! Вот китайцы на них и экономят. Тем не менее, установить дополнительный стабилизатор на линию +12 Вольт можно и самостоятельно. Почему именно +12, а не +5 Вольт? Дело в том, что максимальный ток на линии +5 Вольт по ATX-спецификации может достигать 30 Ампер, стабилизация которых является сложной инженерной задачей, фактически требующей создание второго блока питания. В то же время, предельно допустимый ток на линии +12 Вольт составляет всего 3-4 Ампера, с которыми легко справляется дешевый линейный стабилизатор.

Целью доработки блока питания является отключения линии +12 Вольт от штатного стабилизатора (см. рис. 3) с жесткой фиксацией линии +5 Вольт, что осуществляется подбором сопротивления в цепи обратной связи ШИМ-микросхемы (на рис. 3 он обозначен как R40, а о том, как найти его в произвольном блоке питания по "внешнему виду" подробно рассказывается в статье "разгон с паяльником в руках", которую можно скачать с мыщъхиного сервера — http://nezumi.org.ru/voltmod-final.zip).

{{powers_Image_2.png}}

**Рисунок 3 отключение линии +12 Вольт от штатного стабилизатора (рисунок взят с http://www.overclockers.ru/lab/15748.shtml)**

Другими словами, блок питания будет стабилизировать только линию +5 Вольт, а с линией +12 Вольт мы разберемся и сами. Принципиальная схема простейшего линейного стабилизатора приведена на рис. 4, однако, конкретные схемотехнические решения могут быть и другими. Тут все зависит от опыта, вкуса и ассортимента деталей, имеющихся под рукой.

{{powers_Image_3.jpg}}

**Рисунок 4 принципиальная схема простого линейного стабилизатора на 12 Вольт (рисунок взят с http://www.overclockers.ru/lab/15748.shtml)**

===== конденсаторы и все, что с ними связано =====

"Высыхание" электролитических конденсаторах в цепях фильтров приводит к потере емкости и, как следствие, увеличению амплитуды пульсаций, негативно сказывающихся на стабильности работы процессора, оперативной памяти и, в значительно меньшей степени, жестких дисков.

При "высыхании" конденсаторов в цепях управления интегральными преобразователями (конверторами) напряжения, частота последних растет и может подниматься до болезненно высоких величин, что пагубно сказывается как на самих преобразователях, так и на качестве питающего напряжения.

Последствия высыхания электролитов на базах ключевых транзисторов (на рис. 2 они имеют обозначение C9, C10) имеют весьма далеко идущие последствия. Собственно говоря, сами конденсаторы понадобились затем, чтобы положительное напряжение на базах транзисторов возникало только при подаче открывающих импульсов. При закрывающих импульсах (равно как и в паузах между импульсами), конденсаторы обеспечивают отрицательное напряжение, гарантированно запирающее транзистор и тем самым защищающее его от коммутационных помех, неизбежно возникающих при подобных переключениях.

Для этого достаточно емкости в 1 мкФ или чуть большей с пробивным напряжением конденсатора в 50 Вольт. Однако, со временем емкость постепенно уменьшается и когда она достигает 0.1...0.5 мкФ в паузах между коммутативными импульсами напряжение на базе вплотную приближается к нулевой отметке, в результате чего транзисторы гарантированно закрываются только при запирающих импульсах. Учитывая, что конец и начало импульсов _всегда_ сопровождается коммутационными выбросами, которые могут быть как положительными, так и отрицательными, ключевые транзисторы становятся практически неуправляемыми и начинают хаотично то открываться, то закрываться, в результате чего возникает угроза одновременного открытия обоих ключей сразу, а это сквозной ток и пробой.

Так что, если блок питания уже поработал какое-то время, все электролитические конденсаторы рекомендуется заменить на танталовые или просто любые достойные. При этом следует проверить емкость конденсаторов во входных фильтрах (С5, C6 на рис. 2). Жадные китайцы обычно ее недобирают. Для стабильной работы блока питания необходимо иметь как минимум 1 мкФ на каждый Ватт (т. е. 470 мкФ для 400 Ваттного блока питания вполне достаточно). Пробивное напряжение должно быть не ниже 400 Вольт.

Все электролитические конденсаторы настоятельно рекомендуется зашунтировать керамическими с емкостью порядка 0.33 мкФ и пробивным напряжением взятым с запасом. Дело в том, что электролиты крайне плохо пропускают высокочастотную составляющую, оказывая ей большое сопротивление, а сопротивление, как уже говорилось, обозначает рассеивание тепла и неминуемый разогрев, в результате которого процессы высыхания идут ударными темпами. Керамические конденсаторы же беспрепятственно пропускают ВЧ-составляющую, просто и элегантно решая эту суровую проблему. Кстати, количество "керамики" в блоке питания косвенно позволяет судить о качестве последнего. Чем ее больше — тем лучше.

И последнее. Электролиты, расположенные вблизи радиаторов не помешает изолировать кусочками паронита (или любыми другими теплоизоляторами), однако, ни в коем случае не стоит закатывать конденсатор в паронит целиком! От этого ему только поплохеет.

===== защита блока питания от козы =====

Короткое замыкание (сокращенно КЗ), именуемое в просторечии "козой" — одна из самых неприятный вещей, которая только может случиться с блоком питания, большинство из которых справляются с ней посредством плавкого предохранителя (на схеме, приведенной на рис. 2, он обозначен F1).

Проблема в том, что если блок питания поддерживает несколько входных напряжений (а, как правило, он их поддерживает, во всяком случае в конструктиве), то номинал предохранителя рассчитывается на ток наименьшего напряжения (обычно 110 В), а, поскольку, мощность равна произведению тока на напряжение, то при переходе на 220 В предохранитель работает с большим запасом, который можно было бы и уменьшить, если бы не… начальный ток заряда электролитических конденсаторов. Решение состоит во включении резистора на несколько десятков Ом последовательно с предохранителем, ток которого теперь можно уменьшить или же… вовсе исключить его из схемы, поскольку резистор будет работать как предохранитель, ограничивая ток короткого замыкания (естественно, мощность резистора должна быть достаточно для того чтобы он… _сгорел_ при козе, если же он не сгорит, за него сгорят другие, гораздо более дорогостоящие элементы).

Рассчитать необходимый номинал резистора очень просто. Брем datasheet на ключевые транзисторы и смотрим предельно допустимый ток. Блок питания, схема которого приведена на рис. 2, собран на базе 2SC4242 (Q1, Q2), вот и ищем его технические характеристики в Интернете: http://www.datasheetarchive.com/search.php?q=2SC4242&sType=part, из которых узнаем, что предельно допустимый ток равен 7 Ампер. Делим 370 Вольт на 7 Ампер и получаем, что резистора на 60 Ом будет вполне достаточно.

Спрашиваете, откуда взялась величина 370 Вольт, когда в сети у нас всего 220? Так ведь на мостовом выпрямителя после сглаживания фильтром действующее напряжение увеличивается в 1.7 раз, а 220 Вольт*1.7 == 374 Вольт. Естественно, чем выше сопротивления, тем больше на нем падение напряжение и если перестараться, блоку питания придется очень туго. В лучшем случае он просто будет работать в нештатном режиме, в худшем — просто не сможет обеспечить надлежащее качество питания. Поэтому, брать сопротивление с запасом не стоит. Лучше недобрать, чем перебрать. С другой стороны, даже резистор величиной в 10 Ом ограничит ток короткого замыкания и защита (если таковая предусмотрена) имеет все шансы сработать до того, как ключевые транзисторы вылетят на хрен. А вот плавкий предохранитель, увы, очень часто расплавляется уже после того, как погаснут последние языки пламени и блок питания выгорит дотла.

В целях противопожарной безопасности во входную цепь блока питания желательно поставить терморазмыкатель градусов эдак на 100 по Цельсию, размещенный возле силовых элементов — на случай их катастрофического перегрева.

===== заключение =====

Разумеется, мы охватили далеко не все аспекты доработки блоков питания, однако, завалить читателя массой готовых рецептов — плохая идея. Главное — дать толчок. Показать, что "бюджетные" схемотехнические решения далеки от совершенства и могут быть улучшены весьма простыми и дешевыми (!) средствами. А уж за выбором конкретных реализаций дело не станет!


